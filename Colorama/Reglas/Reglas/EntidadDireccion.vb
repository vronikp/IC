'------------------------------------------------------------------------------
' <auto-generated>
'     This code was generated by a tool.
'     Runtime Version:2.0.50727.42
'
'     Changes to this file may cause incorrect behavior and will be lost if
'     the code is regenerated.
' </auto-generated>
'------------------------------------------------------------------------------

Option Strict Off
Option Explicit On

Imports Infoware.Datos
Imports Infoware.Reglas.General


#Region "EntidadDireccion"
Public Class EntidadDireccion

  Const _Procedimiento As String = "proc_EntidadDireccion"

  Private mPardetTipoDirec As WWTSParametroDet = Nothing

  Private mEntidad As Entidad = Nothing

  Private mPardetCiudad As WWTSParametroDet = Nothing

  Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _EsNuevo As Boolean)
    MyBase.New()
    OperadorDatos = _OperadorDatos
    EsNuevo = _EsNuevo
  End Sub

  Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _Entida_Codigo As Integer, ByVal _PardetTipoDirec As WWTSParametroDet)
    Me.New(_OperadorDatos, False)
    Entida_Codigo = _Entida_Codigo
    PardetTipoDirec = _PardetTipoDirec
    If Me.Recargar Then
    Else
      Throw New System.Exception("No se puede cargar objeto EntidadDireccion")
    End If
  End Sub

  'Parametrodet
  Public Overridable Overloads Property PardetTipoDirec() As WWTSParametroDet
    Get
      If Me.mPardetTipoDirec Is Nothing AndAlso Not Pardet_Tipodireccion = 0 Then
        Me.mPardetTipoDirec = New WWTSParametroDet(OperadorDatos, Parame_Tipodireccion, Pardet_Tipodireccion)
      End If
      Return Me.mPardetTipoDirec
    End Get
    Set(ByVal value As WWTSParametroDet)
      Me.mPardetTipoDirec = value
      Parame_Tipodireccion = value.Parame_Codigo
      Pardet_Tipodireccion = value.Pardet_Secuencia
    End Set
  End Property

  'Entidad
  Public Overridable Property Entidad() As Entidad
    Get
      If Me.mEntidad Is Nothing AndAlso Not Entida_Codigo = 0 Then
        Me.mEntidad = New Entidad(OperadorDatos, Entida_Codigo)
      End If
      Return Me.mEntidad
    End Get
    Set(ByVal value As Entidad)
      Me.mEntidad = value
      Entida_Codigo = Me.mEntidad.Entida_Codigo
    End Set
  End Property

  'Parametrodet
  Public Overridable Overloads Property PardetCiudad() As WWTSParametroDet
    Get
      If Me.mPardetCiudad Is Nothing AndAlso Not Pardet_Ciudad = 0 Then
        Me.mPardetCiudad = New WWTSParametroDet(OperadorDatos, Parame_Ciudad, Pardet_Ciudad)
      End If
      Return Me.mPardetCiudad
    End Get
    Set(ByVal value As WWTSParametroDet)
      Me.mPardetCiudad = value
      Parame_Ciudad = value.Parame_Codigo
      Pardet_Ciudad = value.Pardet_Secuencia
    End Set
  End Property

  Public ReadOnly Property CiudadString() As String
    Get
      If PardetCiudad Is Nothing Then
        Return String.Empty
      Else
        Return PardetCiudad.Pardet_Descripcion
      End If
    End Get
  End Property

  Public ReadOnly Property Descripcion() As String
    Get
      Dim _ciudad As String = String.Empty
      If PardetCiudad IsNot Nothing Then
        _ciudad = PardetCiudad.Pardet_Descripcion
      End If
      Return String.Format("({0}) {1} {2} {3} - {4}", PardetTipoDirec.Pardet_Descripcion, Direcc_Calleprincipal, Direcc_Numero, Direcc_Calleinterseccion, _ciudad)
    End Get
  End Property

  Public Overridable Sub MapearDataRowaObjeto(ByVal Fila As DataRow)
    Entida_Codigo = CType(Fila("Entida_Codigo"), Integer)
    Parame_Tipodireccion = CType(Fila("Parame_Tipodireccion"), Integer)
    Pardet_Tipodireccion = CType(Fila("Pardet_Tipodireccion"), Integer)
    Parame_Ciudad = CType(Fila("Parame_Ciudad"), Integer)
    Pardet_Ciudad = CType(Fila("Pardet_Ciudad"), Integer)
    Direcc_Calleprincipal = CType(Fila("Direcc_Calleprincipal"), String)
    Direcc_Numero = CType(Fila("Direcc_Numero"), String)
    Direcc_Calleinterseccion = CType(Fila("Direcc_Calleinterseccion"), String)
    mPardetTipoDirec = Nothing
    mEntidad = Nothing
    mPardetCiudad = Nothing
  End Sub

  Public Overridable Function Recargar() As Boolean
    Dim Result As System.Data.datatable = New System.Data.datatable
    Dim bReturn As Boolean = True
    OperadorDatos.AgregarParametro("@accion", "C")
    OperadorDatos.AgregarParametro("@Entida_Codigo", Entida_Codigo)
    OperadorDatos.AgregarParametro("@Parame_Tipodireccion", Parame_Tipodireccion)
    OperadorDatos.AgregarParametro("@Pardet_Tipodireccion", Pardet_Tipodireccion)
    OperadorDatos.Procedimiento = _Procedimiento
    bReturn = OperadorDatos.Ejecutar(Result)
    OperadorDatos.LimpiarParametros()
    Try
      Me.MapearDataRowaObjeto(Result.Rows(0))
      EsNuevo = False
      EsModificado = False
    Catch ex As System.Exception
      bReturn = False
    End Try
    Return bReturn
  End Function

  Public Overridable Function Guardar() As Boolean
    If Not EsNuevo And Not EsModificado Then
      Return True
    End If
    Dim Result As Integer = 0
    Dim bReturn As Boolean = True
    Dim sAccion As String = "M"
    If EsNuevo Then
      sAccion = "I"
    End If
    OperadorDatos.AgregarParametro("@accion", sAccion)
    OperadorDatos.AgregarParametro("@Entida_Codigo", Entida_Codigo)
    OperadorDatos.AgregarParametro("@Parame_Tipodireccion", Parame_Tipodireccion)
    OperadorDatos.AgregarParametro("@Pardet_Tipodireccion", Pardet_Tipodireccion)
    OperadorDatos.AgregarParametro("@Parame_Ciudad", Parame_Ciudad)
    OperadorDatos.AgregarParametro("@Pardet_Ciudad", Pardet_Ciudad)
    OperadorDatos.AgregarParametro("@Direcc_Calleprincipal", Direcc_Calleprincipal)
    OperadorDatos.AgregarParametro("@Direcc_Numero", Direcc_Numero)
    OperadorDatos.AgregarParametro("@Direcc_Calleinterseccion", Direcc_Calleinterseccion)
    OperadorDatos.Procedimiento = _Procedimiento
    bReturn = OperadorDatos.Ejecutar(Result)
    OperadorDatos.LimpiarParametros()
    If bReturn Then
      If Not OperadorDatos.EstaenTransaccion Then
        EsNuevo = False
        EsModificado = False
      End If
    End If
    Return bReturn
  End Function

  Public Overridable Sub AceptarCambios()
    EsNuevo = False
    EsModificado = False
  End Sub

  Public Overridable Function Eliminar() As Boolean
    If EsNuevo Then
      Return True
    End If
    Dim bReturn As Boolean = True
    OperadorDatos.AgregarParametro("@accion", "E")
    OperadorDatos.AgregarParametro("@Entida_Codigo", Entida_Codigo)
    OperadorDatos.AgregarParametro("@Parame_Tipodireccion", Parame_Tipodireccion)
    OperadorDatos.AgregarParametro("@Pardet_Tipodireccion", Pardet_Tipodireccion)
    OperadorDatos.Procedimiento = _Procedimiento
    bReturn = OperadorDatos.Ejecutar
    OperadorDatos.LimpiarParametros()
    Return bReturn
  End Function
End Class
#End Region

#Region "EntidadDireccionList"
Public Class EntidadDireccionList
  Inherits System.ComponentModel.BindingList(Of EntidadDireccion)

  Public Shared Function ObtenerLista(ByVal _op As OperadorDatos, ByVal _Entidad As Entidad) As EntidadDireccionList
    Dim oResult As EntidadDireccionList = New EntidadDireccionList
    Dim bReturn As Boolean
    Dim ds As datatable = Nothing
    With _op
      .AgregarParametro("@Accion", "F")
      .AgregarParametro("@Entida_Codigo", _Entidad.Entida_Codigo)
      .Procedimiento = "proc_EntidadDireccion"
      bReturn = .Ejecutar(ds)
      .LimpiarParametros()
    End With
    If bReturn AndAlso Not ds Is Nothing AndAlso ds.Rows.Count > 0 Then
      For Each _dr As DataRow In ds.Rows
        Dim _fila As New EntidadDireccion(_op, False)
        _fila.MapearDataRowaObjeto(_dr)
        oResult.Add(_fila)
      Next
    End If
    Return oResult
  End Function
End Class
#End Region
